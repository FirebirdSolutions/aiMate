@* Sidebar matching Figma Make design *@
@using Fluxor
@using AiMate.Web.Store.Chat
@using AiMate.Web.Store.Project
@inherits Fluxor.Blazor.Web.Components.FluxorComponent
@inject IState<ChatState> ChatState
@inject IState<ProjectState> ProjectState
@inject NavigationManager Navigation

<div class="sidebar">
    <div class="sidebar-header">
        <div class="sidebar-logo">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5zm0 18c-3.87-.96-7-5.38-7-10V8.3l7-3.89 7 3.89V10c0 4.62-3.13 9.04-7 10z"/>
                <path d="M10.9 11.9l-1.4 1.4 4.2 4.2 5.6-5.6-1.4-1.4-4.2 4.2z"/>
            </svg>
            <span>aiMate</span>
        </div>
    </div>

    <div class="sidebar-content">
        @* Start New Chat *@
        <div class="sidebar-section">
            <a href="/" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 5v14M5 12h14"/>
                </svg>
                <span>Start a new chat</span>
            </a>
        </div>

        @* Quick Actions *@
        <div class="sidebar-section">
            <a href="/search" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
                <span>Search</span>
            </a>

            <a href="/notes" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
                    <polyline points="14 2 14 8 20 8"/>
                </svg>
                <span>Notes</span>
            </a>

            <a href="/knowledge" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                </svg>
                <span>Knowledge</span>
            </a>

            <a href="/files" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/>
                    <polyline points="13 2 13 9 20 9"/>
                </svg>
                <span>Files</span>
            </a>
        </div>

        @* Projects Section *@
        <div class="sidebar-section">
            <div class="sidebar-section-title">PROJECTS</div>

            <a href="/projects" class="sidebar-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 5v14M5 12h14"/>
                </svg>
                <span>View All Projects</span>
            </a>

            @foreach (var project in ProjectState.Value.Projects.Take(5))
            {
                <a href="@($"/projects/{project.Id}")" class="sidebar-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                    </svg>
                    <span>@project.Name</span>
                </a>
            }
        </div>

        @* Recent Conversations *@
        <div class="sidebar-section">
            <div class="sidebar-section-title">RECENT</div>

            @foreach (var conversation in ChatState.Value.Conversations.Values
                .Where(c => !c.IsArchived)
                .OrderByDescending(c => c.UpdatedAt)
                .Take(10))
            {
                <a href="@($"/chat/{conversation.Id}")" class="sidebar-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                    </svg>
                    <span>@(conversation.Title.Length > 30 ? conversation.Title.Substring(0, 30) + "..." : conversation.Title)</span>
                </a>
            }
        </div>
    </div>

    <div class="sidebar-footer">
        <a href="/settings" class="sidebar-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/>
                <path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"/>
            </svg>
            <span>Settings</span>
        </a>

        <a href="/archived" class="sidebar-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="21 8 21 21 3 21 3 8"/>
                <rect x="1" y="3" width="22" height="5"/>
                <line x1="10" y1="12" x2="14" y2="12"/>
            </svg>
            <span>Archived</span>
        </a>

        <a href="/admin" class="sidebar-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
            </svg>
            <span>Admin Panel</span>
        </a>

        <a href="/about" class="sidebar-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 16v-4m0-4h.01"/>
            </svg>
            <span>About</span>
        </a>

        <a href="/logout" class="sidebar-item" style="color: var(--error-color);">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4m7 14l5-5-5-5m5 5H9"/>
            </svg>
            <span>Logout</span>
        </a>

        <div class="sidebar-user">
            <div class="sidebar-user-avatar">JD</div>
            <div class="sidebar-user-info">
                <div class="sidebar-user-name">John Doe</div>
                <div class="sidebar-user-email">john.doe@example.com</div>
            </div>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;">
                <polyline points="6 9 12 15 18 9"/>
            </svg>
        </div>
    </div>
</div>

@code {
    // Component uses Fluxor for dynamic data from ChatState and ProjectState
}
